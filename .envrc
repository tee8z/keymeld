# KeyMeld Development Environment
# This file is used by direnv to automatically load the Nix development shell
# when you enter this directory.
#
# To use this:
# 1. Install direnv: https://direnv.net/docs/installation.html
# 2. Install nix: https://nixos.org/download.html
# 3. Run: direnv allow
#
# After that, the development environment will be automatically loaded
# whenever you cd into this directory.

use flake

# Set environment variables for KeyMeld development
export KEYMELD_ENV=development
export RUST_LOG=info,keymeld_gateway=debug,keymeld_enclave=debug
export SQLX_OFFLINE=true

# Set up data directories
export KEYMELD_DATA_DIR="${PWD}/data"
export KEYMELD_KEYS_DIR="/tmp/keymeld-keys"
export BITCOIN_DATA_DIR="${PWD}/data/bitcoin"

# Database configuration
export KEYMELD_DATABASE_PATH="${KEYMELD_DATA_DIR}/keymeld.db"

# Service configuration
export KEYMELD_HOST=127.0.0.1
export KEYMELD_PORT=8090
export CONFIG_PATH="${PWD}/config/development.yaml"
export TEST_MODE=true

# Enclave configuration
export ENCLAVE_3_HOST=127.0.0.1
export ENCLAVE_4_HOST=127.0.0.1
export ENCLAVE_5_HOST=127.0.0.1

# Bitcoin configuration
export BITCOIN_RPC_USER=keymeld
export BITCOIN_RPC_PASSWORD=keymeldpass123
export BITCOIN_RPC_PORT=18443

# Create necessary directories
mkdir -p "${KEYMELD_DATA_DIR}"
mkdir -p "${KEYMELD_KEYS_DIR}"
mkdir -p "${BITCOIN_DATA_DIR}"

echo "ðŸš€ KeyMeld Nix development environment loaded!"
echo "ðŸ’¡ Use 'just help' to see available commands"
echo "âš¡ Use 'just nix-start' to start services with fast Nix builds"
