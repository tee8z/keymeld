just start
ğŸ³ Starting KeyMeld services (development)...
KEYMELD_ENV=dev docker compose up -d
[+] Running 7/7
 â ¿ Network keymeld_keymeld-network  Created                                                                                                                         0.1s
 â ¿ Volume "keymeld_bitcoin-data"    Created                                                                                                                         0.0s
 â ¿ Container keymeld-enclave-2      Healthy                                                                                                                         5.8s
 â ¿ Container keymeld-enclave-1      Healthy                                                                                                                         5.3s
 â ¿ Container keymeld-bitcoin        Started                                                                                                                         0.4s
 â ¿ Container keymeld-enclave-0      Healthy                                                                                                                         5.8s
 â ¿ Container keymeld-gateway        Started                                                                                                                         6.0s
â³ Waiting for services to be ready...
âœ… Services started!
just status
ğŸ” Service Status:
âœ… KeyMeld Gateway (http://localhost:8080)
Bitcoin Core: âœ… Running
just setup-regtest
â›ï¸ Setting up regtest environment...
just mine 101
â›ï¸ Mining 101 blocks to bcrt1qah3jsdmvldlm842urdwv6xgruwnpy926vflnda...
âœ… Mined 101 blocks (total: 101)
âœ… Regtest ready with 101 blocks
just fund-coordinator
ğŸ’° Setting up coordinator wallet in Bitcoin Core...
ğŸ“‹ Creating coordinator wallet in Bitcoin Core...
ğŸ”‘ Coordinator address: bcrt1qvxtdcv7u526gz2zhm98j4d82rr08gqu5zjq3dk
ğŸ’¾ Exporting coordinator master extended private key from Bitcoin Core...
â›ï¸ Mining 101 blocks to coordinator address...
âœ… Coordinator wallet funded with mining rewards
ğŸ’¾ Private key saved to: /tmp/keymeld-keys/coordinator_master.key
ğŸ”‘ Both Bitcoin Core and example will use the same private key
just _demo-no-deps 50000
ğŸ” Running KeyMeld demo on regtest
   Amount: 50000 sats
   Destination: bcrt1qjshlwpdd8lggug6cuazhgexcaz3mt84pccglyq
Starting KeyMeld Example...
Waiting for KeyMeld Gateway at http://gateway:8080...
Gateway is ready!
Starting KeyMeld example...
2025-11-07T02:43:49.612942Z  INFO keymeld_example: Loaded configuration
2025-11-07T02:43:49.613513Z  INFO keymeld_example: Setting up Bitcoin Core wallet for funding...
2025-11-07T02:43:49.613522Z  INFO keymeld_example: âœ… Connected to Bitcoin Core keymeld_coordinator wallet
2025-11-07T02:43:49.614383Z  INFO keymeld_example: âœ… Bitcoin Core keymeld_coordinator wallet balance: 5100 BTC BTC
2025-11-07T02:43:49.614412Z  INFO keymeld_example: Loading coordinator private key from: /app/keys/coordinator_master.key
2025-11-07T02:43:49.614426Z  INFO keymeld_example: Found extended private key (xprv) format from Bitcoin Core
2025-11-07T02:43:49.620646Z  INFO keymeld_example: âœ… Using extended private key from Bitcoin Core with BIP86 derivation
2025-11-07T02:43:49.620827Z  INFO keymeld_example: ğŸ”‘ Persistent Coordinator Address: bcrt1ppndy9ayzvltxzldya0m8dewdcrynjr8aa5gnax9v8g2sr8s8gj7ssrq7ex
2025-11-07T02:43:49.620833Z  INFO keymeld_example: ğŸ’° To fund coordinator manually: bitcoin-cli -regtest -rpcuser=keymeld -rpcpassword=keymeldpass123 generatetoaddress 101 bcrt1ppndy9ayzvltxzldya0m8dewdcrynjr8aa5gnax9v8g2sr8s8gj7ssrq7ex
2025-11-07T02:43:49.667764Z  INFO keymeld_example: ğŸ§ª KeyMeld End-to-End Test - Two-Phase Flow
2025-11-07T02:43:49.667777Z  INFO keymeld_example: ============================================
2025-11-07T02:43:49.667779Z  INFO keymeld_example: Network: regtest
2025-11-07T02:43:49.667781Z  INFO keymeld_example: Gateway: http://gateway:8080
2025-11-07T02:43:49.667783Z  INFO keymeld_example: Participants: 2
2025-11-07T02:43:49.667785Z  INFO keymeld_example: Creating 2 participant wallets...
2025-11-07T02:43:49.675335Z  INFO keymeld_example: Created participant (019a5c32-e123-7a33-95ec-07dd57dc296d): 028fccceb7bec45268d2de017ce04c0f3a7ea0fc83e8f07446edc0813932d925e0 (8fccceb7) - Address: bcrt1p0wykqa7m4ncgeu8arnvn96j7s6qgvdg59vwu2l0r92qlhrv6j8qql5r6k4
2025-11-07T02:43:49.682618Z  INFO keymeld_example: Created participant (019a5c32-e12b-7451-a406-1fa2e974081e): 03562b7fe6de8824548fb6554d26739d0621eba16823d42580fe570c66c8bc1582 (562b7fe6) - Address: bcrt1p4z6vueczvpp7snkxkpxhtfjusrpxqrq4kstdu5am5qf4rg0e8lksthv65q
2025-11-07T02:43:49.682625Z  INFO keymeld_example: ğŸ“¤ Step 1: Funding coordinator's derived address from master wallet...
2025-11-07T02:43:49.682760Z  INFO keymeld_example: ğŸ”‘ Coordinator derived address: bcrt1ppndy9ayzvltxzldya0m8dewdcrynjr8aa5gnax9v8g2sr8s8gj7ssrq7ex
2025-11-07T02:43:49.682777Z  INFO keymeld_example: ğŸ’° Sending 0.0011 BTC from master wallet to coordinator: bcrt1ppndy9ayzvltxzldya0m8dewdcrynjr8aa5gnax9v8g2sr8s8gj7ssrq7ex
2025-11-07T02:43:49.722786Z  INFO keymeld_example: âœ… Funding transaction sent: dfd2216fd5f746941ea3fdfca5a30de78ca0f9cd3a89bf91e09449908ea35b1d
2025-11-07T02:43:49.777553Z  INFO keymeld_example: â›ï¸ Mined 6 blocks to confirm funding
2025-11-07T02:43:49.777569Z  INFO keymeld_example: ğŸ”„ Refreshing coordinator wallet state...
2025-11-07T02:43:49.786179Z  INFO keymeld_example: âœ… Wallet state refreshed! Balance: 0.00110000 BTC sats
2025-11-07T02:43:49.786190Z  INFO keymeld_example:    - Confirmed: 0 BTC sats
2025-11-07T02:43:49.786193Z  INFO keymeld_example:    - Trusted pending: 0 BTC sats
2025-11-07T02:43:49.786194Z  INFO keymeld_example:    - Untrusted pending: 0.00110000 BTC sats
2025-11-07T02:43:49.786196Z  INFO keymeld_example:    - Immature: 0 BTC sats
2025-11-07T02:43:49.786199Z  INFO keymeld_example: ğŸ”‘ Starting Phase 1: Keygen Session
2025-11-07T02:43:49.786209Z  INFO keymeld_example: ğŸ”‘ Creating KeyMeld keygen session...
2025-11-07T02:43:49.787489Z  INFO keymeld_example: Selected enclave enclave-0 with key epoch 1
2025-11-07T02:43:49.788369Z  INFO keymeld_example: ğŸ” Simulating out-of-band session secret sharing...
2025-11-07T02:43:49.788377Z  INFO keymeld_example:    ğŸ“‹ Session ID: 019a5c32-e19b-7e93-ae73-885d3ebdf49d
2025-11-07T02:43:49.788379Z  INFO keymeld_example:    ğŸ”‘ Session Secret (first 10 chars): 4f4051c002...
2025-11-07T02:43:49.788381Z  INFO keymeld_example:    âš ï¸  In production, coordinator would securely share this secret with participants
2025-11-07T02:43:49.788383Z  INFO keymeld_example:       through encrypted channels (Signal, PGP, secure email, in-person, etc.)
2025-11-07T02:43:49.788384Z  INFO keymeld_example:    âš ï¸  This secret enables participants to prove authorization for keygen participation
2025-11-07T02:43:49.788389Z  INFO keymeld_example:    ğŸ“¤ [OUT-OF-BAND] Coordinator securely shares session secret with participant 1 (8fccceb7)
2025-11-07T02:43:49.788391Z  INFO keymeld_example:       ğŸ“± Participant 1 receives and stores session secret securely
2025-11-07T02:43:49.788393Z  INFO keymeld_example:    ğŸ“¤ [OUT-OF-BAND] Coordinator securely shares session secret with participant 2 (562b7fe6)
2025-11-07T02:43:49.788395Z  INFO keymeld_example:       ğŸ“± Participant 2 receives and stores session secret securely
2025-11-07T02:43:49.788397Z  INFO keymeld_example: âœ… Out-of-band session secret sharing simulation completed
2025-11-07T02:43:49.788398Z  INFO keymeld_example:    ğŸ”’ All participants now have the shared secret for HMAC generation
2025-11-07T02:43:49.788400Z  INFO keymeld_example: âœ… Keygen session 019a5c32-e19b-7e93-ae73-885d3ebdf49d created
2025-11-07T02:43:49.788404Z  INFO keymeld_example: ğŸ‘¥ Registering participants for keygen session...
2025-11-07T02:43:49.789104Z  INFO keymeld_example: Keygen session 019a5c32-e19b-7e93-ae73-885d3ebdf49d has 3 available slots
2025-11-07T02:43:49.791603Z  INFO keymeld_example: âœ… Coordinator registered for keygen
2025-11-07T02:43:49.793414Z  INFO keymeld_example: âœ… Participant 0 registered for keygen
2025-11-07T02:43:49.795141Z  INFO keymeld_example: âœ… Participant 1 registered for keygen
2025-11-07T02:43:49.795156Z  INFO keymeld_example: âœ… All participants registered for keygen
2025-11-07T02:43:49.795159Z  INFO keymeld_example: â³ Waiting for keygen completion...
2025-11-07T02:43:49.795670Z  INFO keymeld_example: Keygen still collecting participants...
2025-11-07T02:43:51.799137Z  INFO keymeld_example: âœ… Keygen complete: 02a0867af85c5c01b5ad3629fc333bcbf728cb811d8fbe81f5cde2e1b12d69a994
2025-11-07T02:43:51.799156Z  INFO keymeld_example: ğŸ’° Step 2A: Funding aggregate key address (consolidation transaction)...
2025-11-07T02:43:51.799183Z  INFO keymeld_example: ğŸ¦ Aggregate key taproot address: bcrt1p5zr847zutsqmttfk987rxw7t7u5vhqga37lgrawdutsmzttf4x2q7xdwzh
2025-11-07T02:43:51.803988Z  INFO keymeld_example: âœ… Consolidation transaction sent: f1cbe561ca4fc74b57ca00ee123a9b142b1415dce4fc63f097df3158a8269103
2025-11-07T02:43:51.808137Z  INFO keymeld_example: â›ï¸ Mined 6 blocks to confirm consolidation
2025-11-07T02:43:51.808215Z  INFO keymeld_example: ğŸ“ Step 2B: Creating transaction spending from aggregate key...
2025-11-07T02:43:51.808224Z  INFO keymeld_example: Creating MuSig2 transaction: 50000 sats to bcrt1qjshlwpdd8lggug6cuazhgexcaz3mt84pccglyq
2025-11-07T02:43:51.808229Z  INFO keymeld_example: Spending UTXO: f1cbe561ca4fc74b57ca00ee123a9b142b1415dce4fc63f097df3158a8269103:1 (60000 sats)
2025-11-07T02:43:51.808245Z  INFO keymeld_example: âœ… Using KeyMeld's pre-tweaked MuSig2 aggregate key for Bitcoin compatibility
2025-11-07T02:43:51.808251Z  INFO keymeld_example: âœ… Created MuSig2 transaction with 1 inputs and 2 outputs
2025-11-07T02:43:51.808254Z  INFO keymeld_example: ğŸ” This transaction will be signed using KeyMeld MuSig2
2025-11-07T02:43:51.808257Z  INFO keymeld_example: âœï¸ Starting Phase 2: Signing Session
2025-11-07T02:43:51.808260Z  INFO keymeld_example: âœï¸ Creating signing session...
2025-11-07T02:43:51.811071Z  INFO keymeld_example: âœ… Signing session 019a5c32-e980-7f50-b9b9-15be058b628e created
2025-11-07T02:43:51.811090Z  INFO keymeld_example: â³ Waiting for signing completion...
2025-11-07T02:43:51.811884Z  INFO keymeld_example: Signing still collecting participants...
2025-11-07T02:43:53.815326Z  INFO keymeld_example: Signing still collecting participants...
2025-11-07T02:43:55.818091Z  INFO keymeld_example: Signing still collecting participants...
2025-11-07T02:43:57.821528Z  INFO keymeld_example: Signing session full, waiting for processing...
2025-11-07T02:43:59.825038Z  INFO keymeld_example: Signing session full, waiting for processing...
2025-11-07T02:44:01.828366Z  INFO keymeld_example: Generating nonces...
2025-11-07T02:44:03.830852Z  INFO keymeld_example: Generating nonces...
2025-11-07T02:44:05.833882Z  INFO keymeld_example: Generating nonces...
2025-11-07T02:44:07.836889Z  INFO keymeld_example: Collecting nonces...
2025-11-07T02:44:09.846866Z  INFO keymeld_example: Collecting nonces...
2025-11-07T02:44:11.850569Z  INFO keymeld_example: Aggregating nonces...
2025-11-07T02:44:13.854035Z  INFO keymeld_example: Aggregating nonces...
2025-11-07T02:44:15.861496Z  INFO keymeld_example: Aggregating nonces...
2025-11-07T02:44:17.864174Z  INFO keymeld_example: Generating partial signatures...
2025-11-07T02:44:19.867821Z  INFO keymeld_example: Generating partial signatures...
2025-11-07T02:44:21.878541Z  INFO keymeld_example: Collecting partial signatures...
2025-11-07T02:44:23.880793Z  INFO keymeld_example: Collecting partial signatures...
2025-11-07T02:44:25.883043Z  INFO keymeld_example: Collecting partial signatures...
2025-11-07T02:44:27.892595Z  INFO keymeld_example: Finalizing signature...
2025-11-07T02:44:29.894722Z  INFO keymeld_example: Finalizing signature...
2025-11-07T02:44:31.897218Z  INFO keymeld_example: ğŸ” Applying MuSig2 signature to transaction...
2025-11-07T02:44:31.897245Z  INFO keymeld_example: ğŸ“¡ Broadcasting transaction: b0576b0a7340a5305983f8ce0f54b720927359cec06ff78f2b8e47f70ff9c0fe
2025-11-07T02:44:31.914539Z  INFO keymeld_example: âœ… Transaction broadcast successfully: b0576b0a7340a5305983f8ce0f54b720927359cec06ff78f2b8e47f70ff9c0fe

ğŸ‰ Two-Phase KeyMeld Test Completed Successfully!
âœ… Phase 1: Keygen session completed
âœ… Phase 2: Signing session completed (participants inherited from keygen)
âœ… Aggregate key: 02a0867af85c5c01b5ad3629fc333bcbf728cb811d8fbe81f5cde2e1b12d69a994
âœ… Transaction broadcast: b0576b0a7340a5305983f8ce0f54b720927359cec06ff78f2b8e47f70ff9c0fe
ğŸ“‹ Keygen Session ID: 019a5c32-e19b-7e93-ae73-885d3ebdf49d
ğŸ“‹ Signing Session ID: 019a5c32-e980-7f50-b9b9-15be058b628e

âœ… KeyMeld end-to-end test completed successfully!
