ğŸš€ Starting KeyMeld adaptor signatures quickstart...
ğŸ”§ Setting up VSock (CI-friendly, no password prompts)...
[WARN] âš ï¸  Passwordless sudo not available (this is OK, will use fallback mode)
ğŸ§¹ Cleaning all data...
ğŸ›‘ Stopping services...
âœ… All services stopped
âœ… Clean complete
Building binaries...
warning: Git tree '/home/teebz/repos/keymeld' is dirty
ğŸš€ KeyMeld Development Environment (Rust 1.88.0)
Use 'just help' to see available commands
âœ… VSock available for enclave simulation
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.88s
warning: Git tree '/home/teebz/repos/keymeld' is dirty
ğŸš€ KeyMeld Development Environment (Rust 1.88.0)
Use 'just help' to see available commands
âœ… VSock available for enclave simulation
[WARN] âš ï¸  vhost_vsock: Not available or failed to load (will use fallback mode)
[WARN] âš ï¸  vmw_vsock_loopback: Not available or failed to load (will use fallback mode)
[WARN] âš ï¸  vsock: Not available or failed to load (will use fallback mode)
[WARN] âš ï¸  vsock_loopback: Not available or failed to load (will use fallback mode)
[WARN] No VSock modules loaded - will use TCP fallback
[WARN] ğŸ”„ Falling back to TCP-only mode...
   Access enclaves via:
   - Enclave 0: localhost:9000 â†’ localhost:5000
   - Enclave 1: localhost:9001 â†’ localhost:5001
   - Enclave 2: localhost:9002 â†’ localhost:5002
[SUCCESS] ğŸ‰ VSock setup complete with TCP fallback mode!
ğŸ¦ Setting up Bitcoin regtest environment...
Starting Bitcoin Core...
Bitcoin Core starting
Waiting for Bitcoin Core to start...
Bitcoin Core RPC ready
Generating initial blocks...
âœ… Bitcoin regtest ready with funded coordinator wallet
ğŸš€ Starting KeyMeld services...
âœ… Moto already running
âœ… Services started! Logs available in logs/ directory
ğŸŒ Gateway: http://localhost:8080
â³ Waiting for gateway to be ready...
âœ… Gateway is ready!
â³ Waiting for enclaves to initialize...
ğŸ® Running KeyMeld adaptor demo...
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.35s
     Running `target/debug/keymeld_demo adaptor --config config/example-nix.yaml --amount 50000 --destination bcrt1qf0p0zqynlcq7c4j6vm53qaxapm3chufwfgge80`
2026-01-10T22:23:40.867115Z  INFO keymeld_demo::adaptor: Loaded configuration for adaptor signatures test
2026-01-10T22:23:40.867175Z  INFO keymeld_examples::harness::test: ğŸ”§ Initializing KeyMeld E2E Test
2026-01-10T22:23:40.867197Z  INFO keymeld_examples::harness::test: Network: regtest
2026-01-10T22:23:40.867232Z  INFO keymeld_examples::harness::test: Participants: 2
2026-01-10T22:23:40.867241Z  INFO keymeld_examples::harness::test: Amount: 50000 sats
2026-01-10T22:23:40.867613Z  INFO keymeld_examples::harness::test: ğŸ“ Loading existing coordinator private key from /tmp/keymeld-keys/coordinator.key
2026-01-10T22:23:40.867798Z  INFO keymeld_examples::harness::test: ğŸ‘¤ Coordinator user ID: 019baa02-1143-7980-b2b7-8ac9fa283a64
2026-01-10T22:23:40.956216Z  INFO keymeld_demo::adaptor: ğŸ”§ KeyMeld Adaptor Signatures E2E Test (SDK)
2026-01-10T22:23:40.956257Z  INFO keymeld_demo::adaptor: =============================================
2026-01-10T22:23:40.956273Z  INFO keymeld_demo::adaptor: Network: regtest
2026-01-10T22:23:40.956286Z  INFO keymeld_demo::adaptor: Gateway: http://127.0.0.1:8080
2026-01-10T22:23:40.956300Z  INFO keymeld_demo::adaptor: Participants: 2
2026-01-10T22:23:40.956312Z  INFO keymeld_demo::adaptor: Test Configuration:
2026-01-10T22:23:40.956324Z  INFO keymeld_demo::adaptor:   - Single adaptor: true
2026-01-10T22:23:40.956337Z  INFO keymeld_demo::adaptor:   - And adaptor: true
2026-01-10T22:23:40.956350Z  INFO keymeld_demo::adaptor:   - Or adaptor: true
2026-01-10T22:23:40.956362Z  INFO keymeld_demo::adaptor:   - Skip regular signing: false
2026-01-10T22:23:40.956377Z  INFO keymeld_examples::harness::test: ğŸ‘¥ Loading participant keys...
2026-01-10T22:23:40.956406Z  INFO keymeld_examples::harness::test: ğŸ“ Loading participant 1 key from /tmp/keymeld-keys/participant_1.key
2026-01-10T22:23:41.044502Z  INFO keymeld_examples::harness::test: âœ… Loaded 1 participants
2026-01-10T22:23:41.044555Z  INFO keymeld_examples::harness::test: ğŸ’° Funding coordinator from master wallet...
2026-01-10T22:23:41.046024Z  INFO keymeld_examples::harness::test: ğŸ“ Coordinator address: bcrt1p9zkwzyk7xqrm9gs77uezdnm8jayx940rlxfjtu4zs0tmdpum4gqqgy7cyx
2026-01-10T22:23:41.046093Z  INFO keymeld_examples::harness::test: ğŸ’¸ Sending 110000 sats to coordinator
2026-01-10T22:23:41.069809Z  INFO keymeld_examples::harness::test: ğŸ“¡ Funding transaction: 4bf6cd108ed4764e9e9ef4da9c4cf90550bc20d1d6f6f49ab164dd443dd6d3d5
2026-01-10T22:23:41.069870Z  INFO keymeld_examples::harness::test: â›ï¸ Mining block to confirm transaction...
2026-01-10T22:23:41.072637Z  INFO keymeld_examples::harness::test: âœ… Funding confirmed
2026-01-10T22:23:41.072684Z  INFO keymeld_demo::adaptor: ğŸ”‘ Starting Phase 1: Keygen Session (SDK)
2026-01-10T22:23:41.072701Z  INFO keymeld_examples::harness::test: ğŸ”‘ Running complete keygen flow using SDK...
2026-01-10T22:23:41.072749Z  INFO keymeld_examples::harness::test: ğŸ¥ Waiting for all enclaves to be healthy...
2026-01-10T22:23:41.081676Z  INFO keymeld_examples::harness::test: ğŸ¥ Health check: 3/3 enclaves healthy
2026-01-10T22:23:41.081717Z  INFO keymeld_examples::harness::test: âœ… All 3 enclaves are healthy, proceeding with registration
2026-01-10T22:23:41.101655Z  INFO keymeld_examples::harness::test: âœ… Keygen session created: 019baa02-121a-7ea3-831b-1da6d611414c
2026-01-10T22:23:41.101752Z  INFO keymeld_examples::harness::test: ğŸ‘¤ Registering coordinator...
2026-01-10T22:23:41.114558Z  INFO keymeld_examples::harness::test: âœ… Coordinator registered
2026-01-10T22:23:41.114628Z  INFO keymeld_examples::harness::test: ğŸ‘¤ Registering participant 0...
2026-01-10T22:23:41.134578Z  INFO keymeld_examples::harness::test: âœ… Participant 0 registered
2026-01-10T22:23:41.134653Z  INFO keymeld_examples::harness::test: â³ Waiting for keygen completion...
2026-01-10T22:23:41.400213Z  INFO keymeld_examples::harness::test: âœ… Keygen complete, aggregate key: 03e716116bb71d7358d9da0d6d7131cf44ec26ced5b9d5a746bde7dec50eb09b36
2026-01-10T22:23:41.400261Z  INFO keymeld_demo::adaptor: âœ… Keygen complete: 03e716116bb71d7358d9da0d6d7131cf44ec26ced5b9d5a746bde7dec50eb09b36
2026-01-10T22:23:41.400289Z  INFO keymeld_examples::harness::test: ğŸ’° Funding aggregate key address...
2026-01-10T22:23:41.400359Z  INFO keymeld_examples::harness::test: ğŸ“ Aggregate key address: bcrt1puutpz6ahr4e43kw6p4khzvw0gnkzdnk4h826w34aul0v2r4snvmqg08qkz
2026-01-10T22:23:41.426854Z  INFO keymeld_examples::harness::test: ğŸ“¡ Funding transaction: 17adf249f6c8518b288ba88ca6d9fb46c4f7bbe043fabc9d9aecceaa44852f00
2026-01-10T22:23:42.432869Z  INFO keymeld_examples::harness::test: âœ… Aggregate funding confirmed
2026-01-10T22:23:42.434241Z  INFO keymeld_examples::harness::test: âœ… Found aggregate key output at index 1
2026-01-10T22:23:42.434273Z  INFO keymeld_examples::harness::test: ğŸ“ Creating MuSig2 transaction...
2026-01-10T22:23:42.434347Z  INFO keymeld_examples::harness::test: ğŸ” Key details for transaction:
2026-01-10T22:23:42.434358Z  INFO keymeld_examples::harness::test:   - Aggregate key hex: 03e716116bb71d7358d9da0d6d7131cf44ec26ced5b9d5a746bde7dec50eb09b36
2026-01-10T22:23:42.434374Z  INFO keymeld_examples::harness::test:   - Aggregate key (compressed): 03e716116bb71d7358d9da0d6d7131cf44ec26ced5b9d5a746bde7dec50eb09b36
2026-01-10T22:23:42.434390Z  INFO keymeld_examples::harness::test:   - Aggregate key (x-only): e716116bb71d7358d9da0d6d7131cf44ec26ced5b9d5a746bde7dec50eb09b36
2026-01-10T22:23:42.434403Z  INFO keymeld_examples::harness::test:   - Parity: Odd
2026-01-10T22:23:42.435597Z  INFO keymeld_examples::harness::test: âœ… UTXO scriptPubKey verification passed - matches current aggregate key
2026-01-10T22:23:42.435650Z  INFO keymeld_examples::harness::test: âœ… Transaction created with 1 inputs and 2 outputs
2026-01-10T22:23:42.435665Z  INFO keymeld_demo::adaptor: ğŸ”§ Starting Adaptor Signatures Test
2026-01-10T22:23:42.435676Z  INFO keymeld_examples::harness::adaptor_utils: ğŸ”‘ Generating secret for single adaptor signature
2026-01-10T22:23:42.436085Z  INFO keymeld_examples::harness::adaptor_utils: ğŸ”‘ Generating secrets for AND adaptor signature
2026-01-10T22:23:42.436841Z  INFO keymeld_examples::harness::adaptor_utils: ğŸ”‘ Generating secrets for OR adaptor signature
2026-01-10T22:23:42.437574Z  INFO keymeld_demo::adaptor: ğŸ“ Created 3 adaptor configurations with 5 secrets
2026-01-10T22:23:42.437589Z  INFO keymeld_demo::adaptor:   Config 1: Single with 1 points
2026-01-10T22:23:42.437597Z  INFO keymeld_demo::adaptor:   Config 2: And with 2 points
2026-01-10T22:23:42.437605Z  INFO keymeld_demo::adaptor:   Config 3: Or with 2 points
2026-01-10T22:23:42.437614Z  INFO keymeld_demo::adaptor: âœï¸ Starting Phase 2: Signing Session with Adaptor Signatures
2026-01-10T22:23:42.437746Z  INFO keymeld_examples::harness::test:   - Input 0 value: 55000 sats
2026-01-10T22:23:42.437771Z  INFO keymeld_examples::harness::test:   - Input 0 scriptPubKey: 5120e716116bb71d7358d9da0d6d7131cf44ec26ced5b9d5a746bde7dec50eb09b36
2026-01-10T22:23:42.437887Z  INFO keymeld_examples::harness::test:   - Input 0 value: 55000 sats
2026-01-10T22:23:42.437901Z  INFO keymeld_examples::harness::test:   - Input 0 scriptPubKey: 5120e716116bb71d7358d9da0d6d7131cf44ec26ced5b9d5a746bde7dec50eb09b36
2026-01-10T22:23:42.437975Z  INFO keymeld_demo::adaptor: ğŸ”’ Encrypting 3 adaptor configurations on client side
2026-01-10T22:23:42.438516Z  INFO keymeld_demo::adaptor: âœ… Verified zero-knowledge privacy: gateway cannot see adaptor IDs or business logic
2026-01-10T22:23:42.467775Z  INFO keymeld_demo::adaptor: âœ… Signing session 019baa02-1765-7eb3-9f01-3bec4f3cb066 created with adaptor configurations
2026-01-10T22:23:42.467880Z  INFO keymeld_demo::adaptor: ğŸ” Validating message before approval: cae7084ca97e1db8efe967220eac71a5916f20ca1354c6ac8a36c3ab8ea01d08
2026-01-10T22:23:42.467901Z  INFO keymeld_examples::harness::test: ğŸ“ Starting approval process for signing session 019baa02-1765-7eb3-9f01-3bec4f3cb066 and user: 019baa02-1143-7980-b2b7-8ac9fa283a64
2026-01-10T22:23:42.472576Z  INFO keymeld_examples::harness::test: âœ… Signing session 019baa02-1765-7eb3-9f01-3bec4f3cb066 successfully approved for user: 019baa02-1143-7980-b2b7-8ac9fa283a64
2026-01-10T22:23:42.472639Z  INFO keymeld_demo::adaptor: ğŸ” Participant 0 validating message before approval
2026-01-10T22:23:42.472653Z  INFO keymeld_examples::harness::test: ğŸ“ Starting approval process for signing session 019baa02-1765-7eb3-9f01-3bec4f3cb066 and user: 019baa02-11f3-7d70-b239-8cebded68edb
2026-01-10T22:23:42.476971Z  INFO keymeld_examples::harness::test: âœ… Signing session 019baa02-1765-7eb3-9f01-3bec4f3cb066 successfully approved for user: 019baa02-11f3-7d70-b239-8cebded68edb
2026-01-10T22:23:42.477043Z  INFO keymeld_demo::adaptor: âœ… All required approvals completed - signing can now proceed
2026-01-10T22:23:42.477059Z  INFO keymeld_demo::adaptor: â³ Waiting for signing completion with adaptor processing...
2026-01-10T22:23:42.484450Z  INFO keymeld_demo::adaptor: â³ Signing still collecting participants...
2026-01-10T22:23:44.510750Z  INFO keymeld_demo::adaptor: Decrypting adaptor signatures on client side
2026-01-10T22:23:44.513100Z  INFO keymeld_demo::adaptor: Adaptor signing completed!
2026-01-10T22:23:44.513117Z  INFO keymeld_demo::adaptor: Successfully decrypted 3 adaptor signatures
2026-01-10T22:23:44.513130Z  INFO keymeld_examples::harness::adaptor_utils: Validating adaptor signatures...
2026-01-10T22:23:44.513160Z  INFO keymeld_examples::harness::adaptor_utils: âœ… Single adaptor signature validated: ID=019baa02-1764-7ce0-93e6-f0b8094b03f0
2026-01-10T22:23:44.513194Z  INFO keymeld_examples::harness::adaptor_utils: âœ… And adaptor signature validated: ID=019baa02-1764-7ce0-93e6-f0c5db599aa2
2026-01-10T22:23:44.513224Z  INFO keymeld_examples::harness::adaptor_utils: âœ… Or adaptor signature validated: ID=019baa02-1765-7eb3-9f01-3bd977ce4d9e
2026-01-10T22:23:44.513237Z  INFO keymeld_examples::harness::adaptor_utils: âœ… All adaptor signatures validated successfully
2026-01-10T22:23:44.513248Z  INFO keymeld_demo::adaptor: ğŸ­ Demonstrating complete adaptor signature flow...
2026-01-10T22:23:44.513259Z  INFO keymeld_demo::adaptor: ğŸ”‘ Step 1: Revealing adaptor secrets (in real scenarios, this happens through external events)
2026-01-10T22:23:44.513363Z  INFO keymeld_examples::harness::test:   - Input 0 value: 55000 sats
2026-01-10T22:23:44.513378Z  INFO keymeld_examples::harness::test:   - Input 0 scriptPubKey: 5120e716116bb71d7358d9da0d6d7131cf44ec26ced5b9d5a746bde7dec50eb09b36
2026-01-10T22:23:44.513447Z  INFO keymeld_demo::adaptor: ğŸ”‘ Step 2: Adapting signatures using revealed secrets...
2026-01-10T22:23:44.513459Z  INFO keymeld_examples::harness::adaptor_utils: ğŸ”“ Adapting adaptor signatures with revealed secrets...
2026-01-10T22:23:44.513471Z  INFO keymeld_examples::harness::adaptor_utils: ğŸ”“ Adapting Single signature for config 019baa02-1764-7ce0-93e6-f0b8094b03f0
2026-01-10T22:23:44.513536Z  INFO keymeld_examples::harness::adaptor_utils: ğŸ”“ Applying secret to adapt signature...
2026-01-10T22:23:44.514113Z  INFO keymeld_examples::harness::adaptor_utils: ğŸ” Verifying adapted signature...
2026-01-10T22:23:44.514753Z  INFO keymeld_examples::harness::adaptor_utils: âœ… Single signature adapted and verified successfully!
2026-01-10T22:23:44.514799Z  INFO keymeld_examples::harness::test:   - Input 0 value: 55000 sats
2026-01-10T22:23:44.514811Z  INFO keymeld_examples::harness::test:   - Input 0 scriptPubKey: 5120e716116bb71d7358d9da0d6d7131cf44ec26ced5b9d5a746bde7dec50eb09b36
2026-01-10T22:23:44.514866Z  INFO keymeld_demo::adaptor: âœ… Message verified before broadcast
2026-01-10T22:23:44.514880Z  INFO keymeld_demo::adaptor: ğŸ”‘ Step 3: Broadcasting transaction with adapted signature...
2026-01-10T22:23:44.514892Z  INFO keymeld_examples::harness::test: ğŸ“ Applying signature to transaction...
2026-01-10T22:23:44.514940Z  INFO keymeld_examples::harness::test: ğŸ” Transaction being broadcast:
2026-01-10T22:23:44.514967Z  INFO keymeld_examples::harness::test:   - Transaction ID: 89802a7cf101e1632dda4cda35552e3f0321c356c0d27f29d428eda5154fbb26
2026-01-10T22:23:44.514993Z  INFO keymeld_examples::harness::test: âœ… Transaction signed successfully
2026-01-10T22:23:44.516148Z  INFO keymeld_examples::harness::test: ğŸ“¡ Transaction broadcast successfully: 89802a7cf101e1632dda4cda35552e3f0321c356c0d27f29d428eda5154fbb26
2026-01-10T22:23:44.516210Z  INFO keymeld_demo::adaptor: âœ… Transaction broadcast with adapted signature: 89802a7cf101e1632dda4cda35552e3f0321c356c0d27f29d428eda5154fbb26

ğŸ‰ All Adaptor Signature Tests Completed Successfully!
===============================================
âœ… Aggregate key: 03e716116bb71d7358d9da0d6d7131cf44ec26ced5b9d5a746bde7dec50eb09b36
ğŸ“‹ Adaptor Signature 1 Details:
   Type: Single
   ID: 019baa02-1764-7ce0-93e6-f0b8094b03f0
   Points: 1 adaptor points
   Signature scalar: 037c5b8fadbee37c...
   Nonce point: 03a7aeb59ecb4a6b...
   Aggregate adaptor point: 0326f971ced3da16...

ğŸ“‹ Adaptor Signature 2 Details:
   Type: And
   ID: 019baa02-1764-7ce0-93e6-f0c5db599aa2
   Points: 2 adaptor points
   Signature scalar: 022865c348201b71...
   Nonce point: 03d2ab40b7bd08cf...
   Aggregate adaptor point: 027ac6b732e8ce27...

ğŸ“‹ Adaptor Signature 3 Details:
   Type: Or
   ID: 019baa02-1765-7eb3-9f01-3bd977ce4d9e
   Points: 2 adaptor points
   Hints: 2 hints provided
   Signature scalar: 033fcdc26af9aaca...
   Nonce point: 03da6f4f0b1b8759...
   Aggregate adaptor point: 03f6f30defceffa2...


âœ… KeyMeld adaptor signatures test completed successfully!
